# 클러스터 서비스

서로 필요한 곳에 연결하여 서비스 정보를 교환한다. 분산 처리가 가능하게 한다. 
- 서비스로 전송할 수 있다.
- service_access_point (sap) --> service reference로 했다.
  - 내부에 프로토콜을 갖는다.
  - sap->protocol->send()
  - sap->protocol->sub()
  - sap->protocol->unsub()
- cluster_service->search( cond )
  - sap = cs->get(name)
  - sap->send()
  - sap->sub()
  - sap->unsub()

분산 처리에서 문제는 두 가지이다. 
- 노드가 죽거나 단선이 발생할 경우 처리를 어떻게 깔끔하고 편하게 만들 수 있는가?
- SPOF가 없거나 줄이는 방법은 무엇일까?

방법이 있긴 한 걸까? 깔끔하게 문제가 있는 지 확인하고 처리할 수 있게 한다. 
- heartbeat와 에러 처리
- 재접속 시 에러 처리 

작은 데이터 서비스는 분산 캐시로 SPOF를 없앨 수 있다.
- 인증 같은 경우가 여기에 해당한다.

데이터 복제가 서비스와 노드 단위로 이루어져야 한다.
그래야 분산처리가 편하다. 편하게 복제할 방법이 있어야 한다.

분산처리는 이론적으로도 어렵고 실제로도 어렵다. 
완전히 분리된 단일 프로세스처럼 생각하고 개별 서비스를 구현한다.

요청을 보낼 때 해당 서비스가 unavaible 하면 처리를 해야 하는 경우만 주의한다.
- 체크 ==> 전송
- 에러 ==> 처리

이를 패턴화 한다. 그러면 대부분의 경우 SPOF가 있더라도 문제가 없다.
대부분 빠르게 다시 살아난다.



