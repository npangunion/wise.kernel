# 기본 프로토콜 구현 

빠르고 사용이 편한 serialization 라이브러리는 통신에서 기본이다. 
빠름 때문에 flatbuffers를 사용하는 경우가 있는데 버퍼 때문에 오히려 느려질 수도 있다. 
여러 언어를 안정적으로 지원해야 하는 것도 중요한 요구 사항이다. 

다음이 중요하다. 
- 속도 
- 지원 언어 
- 사용 편의 

## 모색

- msgpack 
- bitsery 
- flatbuffers
- thrift
- 자체 제작 

이미 개발이나 사용 경험이 있는 라이브러리를 대상으로 생각해 본다. 

### msgpack 

c#, python 구현은 좋고 잘 맞는다. c++ 구현은 좀 떨어진다. 
IDL이 없으므로 수작업으로 맞춰야 하는 단점이 있다.

### bitsery 

매우 빠르고 사용도 편하다. C++만 있다는 게 단점이다. 
게임 개발을 위해 제작했다고 한다. 
flatbuffers와 비교도 했는데 serialization 성능은 비교가 안 된다. 

### flatbuffers 

버퍼를 들고 다니기 때문에 버퍼 관리가 매우 빨라야 한다. 
메모리 관리와 동일한 여러 이슈들이 생긴다. 

그 외에는 모두 좋다. 사용이 불편한 면이 있다. 

### thrift 

고전적이며 안정적이다. 페북이 개발하고 유지보수를 하고 있다. 

### 자체 제작 

고생이다. IDL 컴파일러와 코드 생성기를 만들고 성능도 계속 높여야 한다. 

## 방향 

msgpack의 C++ 구현을 만들고 몇 가지 언어에 대해 IDL을 어느 정도 제공하면 
괜찮을 수 있다. msgpack 부흥과 C++ 적용 운동이라고 생각하고 시도해 볼 수 있다. 
bitsery의 serialization 자동화를 msgpack 형식으로 가져오는 걸 진행하면 어떨까? 

- msgpack c++ 라이브러리 개발 
  - 시간이 좀 오래 걸릴 듯 하다. 
  
- bitsery 사용
  - 언어 호환이 안 되는 문제가 있다. 

- c++ 간, 서버 내에서 bitsery를 사용
- c#이나 다른 언어는 msgpack을 지원 


두 가지 프로토콜을 지원. 어떤가? 좋은 생각인가? 아닐 듯 싶다. 
- ifun은 protobuf를 사용한다. 

안정되고 오래된 방식으로 기본 성능을 제공하는 프로토콜을 사용하고 
특수한 상황에서 매우 빠른 기능을 제공하는 프로토콜을 지원한다. 

- protobuf + bits 

bits를 먼저 구현하고 (이전에 한번 했으므로), protobuf로 여러 언어를 지원한다. 
두 개 프로토콜 사용이 통합될 수 있어야 한다. 














